<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="referrer" content="no-referrer" />

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="referrer" content="no-referrer" /><script src="/__qrator/qauth_utm_v2d_v9118.js" charset="utf-8"></script>

    <script>
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        qauth_handle_validate_success = function() {
            var host_to_source_map = {
                "duckduckgo.com": "duckduckgo",
                "go.mail.ru": "mail.ru",
                "google.ru": "google",
                "ru.search.yahoo.com": "yahoo",
                "www.bing.com": "bing",
                "www.google.ae": "google",
                "www.google.at": "google",
                "www.google.az": "google",
                "www.google.be": "google",
                "www.google.by": "google",
                "www.google.ca": "google",
                "www.google.ch": "google",
                "www.google.co.jp": "google",
                "www.google.co.kr": "google",
                "www.google.co.th": "google",
                "www.google.co.uk": "google",
                "www.google.co.uz": "google",
                "www.google.com": "google",
                "www.google.com.au": "google",
                "www.google.com.hk": "google",
                "www.google.com.sg": "google",
                "www.google.com.sv": "google",
                "www.google.com.tr": "google",
                "www.google.com.ua": "google",
                "www.google.de": "google",
                "www.google.es": "google",
                "www.google.fi": "google",
                "www.google.fr": "google",
                "www.google.it": "google",
                "www.google.kz": "google",
                "www.google.lt": "google",
                "www.google.lv": "google",
                "www.google.nl": "google",
                "www.google.no": "google",
                "www.google.pl": "google",
                "www.google.ro": "google",
                "www.google.ru": "google",
                "www.google.se": "google",
                "www.google.sm": "google",
                "www.yandex.by": "yandex",
                "www.yandex.fr": "yandex",
                "www.yandex.kz": "yandex",
                "www.yandex.ru": "yandex",
                "ya.ru": "yandex",
                "yandex.by": "yandex",
                "yandex.com": "yandex",
                "yandex.com.tr": "yandex",
                "yandex.eu": "yandex",
                "yandex.kz": "yandex",
                "yandex.ru": "yandex",
                "yandex.uz": "yandex",
            };

            var host_to_internal_map = {
                "dns-shop.ru": "internal",
                "www.dns-shop.ru": "internal",
                "restapi.dns-shop.ru": "internal",
                "webapi.dns-shop.ru": "internal",
                "cart.dns-shop.ru": "internal",
                "shops.dns-shop.ru": "internal",
            };

            var new_query_str = window.location.search;
            var new_query_changed = false;

            try {
                if (document.referrer !== "") {
                    var ref_host = new URL(document.referrer).hostname;

                    var new_utm_source = '';
                    var new_utm_medium = '';

                    var ref_source = host_to_source_map[ref_host];
                    var ref_internal = host_to_internal_map[ref_host];

                    if( ref_source !== undefined) {
                        new_utm_source = ref_source;
                        new_utm_medium = "organic";
                    } else if( ref_internal !== undefined) {
                        new_utm_source = '';
                        new_utm_medium = '';
                    } else {
                        new_utm_source = ref_host;
                        new_utm_medium = "referral";
                    }

                    if(getParameterByName("utm_source")) {
                        new_utm_source = '';
                    }
                    if(getParameterByName("utm_medium")) {
                        new_utm_medium = '';
                    }

                    if(new_utm_medium !== '') {
                        new_query_str += (new_query_str.length === 0?"?":"&") + "utm_medium=" + encodeURIComponent(new_utm_medium);
                        new_query_changed = true
                    }

                    if(new_utm_source !== '') {
                        new_query_str += (new_query_str.length === 0 ? 